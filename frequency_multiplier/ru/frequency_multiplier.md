# Умножение частот

В этом посте поговорим об умножении частоты прямоугольных сигналов на 2.

В цифровой схемотехнике, когда нужен clk с частотой ниже имеющейся, часто используют счётчик в качестве преобразователя. Так можно частоту поделить на 2 в степени, равной разрядности счётчика. Однако, этот способ не даёт возможности увеличить частоту сигнала. Для этого сигнал удвоенной частоты должен переключаться не только при изменении входного сигнала, но и в момент, когда все сигналы постоянны.

![](../media/task.svg)

В ПЛИС (например, Altera Cyclone IV, как на схеме ниже) в этом случае используют аналоговые блоки автоподстройки частоты – PLL. Это большие схемы, в которых генератором управляют через отрицательную обратную связь.

![](../media/pll.png)

Реализовать умножение частоты на 2, на самом деле, значительно проще. Достаточно сместить исходный сигнал clk на четверть периода. Далее можно использовать комбинационную логику.

![](../media/how_to.svg)

Как видим, нужно выполнить XOR между исходным и смещённым сигналами.

Остаётся аналоговая часть: как сдвинуть сигнал на четверть периода?

Как вариант - RC-цепью внести задержку распространения. Возможно, это первый вариант, который придет в голову. Основной недостаток - величина задержки зависит от R и C, но не от частоты исходного сигнала. То есть, нужно или менять номиналы подключением или отключением резисторов/конденсаторов, или использовать управляемые элементы (например, транзисторы вместо резисторов).

Второй вариант от частоты зависит значительно меньше: нужно выделить треугольный сигнал, который будет повышаться, когда на входе 1, и понижаться, когда 0. Соответственно, на выход нужно подавать 1, когда величина сигнала больше его среднего значения.

<img src="../media/analog_triangle.svg" style="width:150%;height:auto" />

Реализуется он, на самом деле, той же RC-цепочкой. Действительно, чтобы получить треугольник, можно проинтегрировать входной прямоугольный сигнал.

<img src="../media/structure.svg" style="width:150%; height=auto"/>

Переходные процессы в такой цепи экспоненциальные. Это приводит к смещению выделенного сигнала относительно четверти периода, как на картинке ниже.

![](../media/exponent.png)

Из-за этого лучше перезаряжать конденсатор источником тока - транзистором, который для симметрии надо дополнить до проходного ключа.

($I=C\frac{dU}{dt}=const$ - получается идеальная прямая)

Полученный треугольник нужно растянуть до прямоугольника. Когда сигнал больше своего среднего, его нужно усилить до питания, когда меньше - до нуля. Естественно, для этого нужен буфер. На его входе нужно задать смещение, чтобы по постоянному току на выходе была половина питания. Это позволит избежать искажений и проблем при усилении.


